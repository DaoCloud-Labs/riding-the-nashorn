<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="Niko Köbler">
<title>Riding the Nashorn</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="css//asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="css//coderay-asciidoctor.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Riding the Nashorn</h1>
<div class="details">
<span id="author" class="author">Niko Köbler</span><br>
<span id="email" class="email"><a href="mailto:niko@n-k.de">niko@n-k.de</a>, <a href="http://www.n-k.de" class="bare">http://www.n-k.de</a>, <a href="https://twitter.com/dasniko">@dasniko</a></span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_nashorn_at_the_command_line_interface_cli">1. Nashorn at the Command Line Interface (CLI)</a>
<ul class="sectlevel2">
<li><a href="#_scripting_mode">1.1. Scripting mode</a></li>
<li><a href="#_shebang">1.2. Shebang</a></li>
</ul>
</li>
<li><a href="#_nashorn_javascript_engine">2. Nashorn JavaScript Engine</a></li>
<li><a href="#_api_and_language_extensions">3. API and Language Extensions</a></li>
<li><a href="#_package_manager">4. Package Manager</a>
<ul class="sectlevel2">
<li><a href="#_npm">4.1. NPM</a></li>
<li><a href="#_maven">4.2. Maven</a></li>
</ul>
</li>
<li><a href="#_isomorphic_javascript">5. Isomorphic JavaScript</a>
<ul class="sectlevel2">
<li><a href="#_isomorphic">5.1. Isomorphic?</a></li>
<li><a href="#_react_js">5.2. React.js</a></li>
<li><a href="#_spring_boot_mvc">5.3. Spring Boot MVC</a></li>
<li><a href="#_java_ee_8_mvc_1_0">5.4. Java EE 8 MVC 1.0</a></li>
</ul>
</li>
<li><a href="#_javafx_with_javascript">6. JavaFX with JavaScript</a></li>
<li><a href="#_testing_of_nashorn_scripts">7. Testing of Nashorn Scripts</a>
<ul class="sectlevel2">
<li><a href="#_junit">7.1. JUnit</a></li>
<li><a href="#_spock">7.2. Spock</a></li>
<li><a href="#_jasmine">7.3. Jasmine</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Nashorn is the official JavaScript Engine in the Java Virtual Machine since Version 8.
It supports and implements the ECMAScript 5.1 specification and competes among others directly with <a href="https://developers.google.com/v8/">Google V8</a> (the script enginge behind <a href="https://nodejs.org">Node.js</a>).
Nashorn compiles JavaScript to Java Bytecode during runtime and thus provides high interoperability of Java and JavaScript.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/nashorn.jpg" alt="Nashorn">
</div>
</div>
<div class="paragraph">
<p>In this script I want to dig into some of the (IMO) most used options, functions, features, and use-cases.
After working through this tutorial you&#8217;ll be able to use Nashorn and its dynamic scripting features in your daily Java business.</p>
</div>
<div class="paragraph">
<p><em>Another good starting point for Nashorn resources might be the <a href="http://openjdk.java.net/projects/nashorn/">Official Project Nashorn Website</a> with links to the mailing-list, the blog and the wiki pages. Check it out!</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nashorn_at_the_command_line_interface_cli">1. Nashorn at the Command Line Interface (CLI)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nashorn comes with a command line client named <code>jjs</code>.</p>
</div>
<div class="paragraph">
<p>This client is located in <code>$JAVA_HOME/bin</code>, but there&#8217;s no shortcut/link/path integration after installation Java 8.
So, if you want to work with <code>jjs</code> - and that&#8217;s what we want to do here - you should create a link to the tool:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ cd /usr/bin
$ ln -s $JAVA_HOME/bin/jjs jjs
$ jjs
jjs&gt; print('Hello World');</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now evaluate JavaScript code directly in the jjs shell.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js">jjs&gt; <span class="keyword">var</span> x = <span class="integer">10</span>;
jjs&gt; print(x);
<span class="integer">10</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally you can load and execute JavaScript files with the <code>jjs</code> tool:</p>
</div>
<div class="listingblock">
<div class="title">test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js"><span class="keyword">var</span> x = <span class="integer">10</span>;
<span class="keyword">var</span> y = <span class="integer">20</span>;
print(x + y);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ jjs test.js
30</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>jjs</code> client can be exited by calling</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js">jjs&gt; exit()
jjs&gt; exit(<span class="integer">1</span>)

jjs&gt; quit()
jjs&gt; quit(<span class="integer">1</span>)</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_scripting_mode">1.1. Scripting mode</h3>
<div class="paragraph">
<p>In addition to the ECMAScript 5.1 specification, Nashorn implements a number of own syntax and API extensions as well <em>(see one of the next chapters)</em>.
Many of these extensions are only available in <code>scripting</code> mode. <code>Scripting</code> mode is turned on by using the cli option <code>--scripting</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ jjs --scripting</code></pre>
</div>
</div>
<div class="paragraph">
<p>In <code>scripting</code> mode, nashorn accepts shell style <code>#</code> single line comments:</p>
</div>
<div class="listingblock">
<div class="title">test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js"><span class="error">#</span> style line comment -scripting mode
<span class="error">#</span> prints hello

print(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_shebang">1.2. Shebang</h3>
<div class="paragraph">
<p>Nashorn supports shebang scripting.
So, instead of calling your JavaScript file like the traditional way:</p>
</div>
<div class="listingblock">
<div class="title">test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js">print(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ jjs test.js</code></pre>
</div>
</div>
<div class="paragraph">
<p>Just write your JavaScript file like the following with a shebang at first line:</p>
</div>
<div class="listingblock">
<div class="title">test.js</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="js"><span class="error">#</span>!<span class="regexp"><span class="delimiter">/</span><span class="content">usr</span><span class="delimiter">/</span></span>bin/jjs
print(<span class="string"><span class="delimiter">'</span><span class="content">hello</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>make it executable and call it from the command line, like any other shell script:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sh">$ chmod 755 test.js
$ ./test.js</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You&#8217;ll need to have a link to <code>jjs</code> as mentioned at the beginning of this chapter.<br>
Scripting mode is automatically enabled when running shebang Nashorn scripts.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_nashorn_javascript_engine">2. Nashorn JavaScript Engine</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_api_and_language_extensions">3. API and Language Extensions</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_package_manager">4. Package Manager</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_npm">4.1. NPM</h3>
<div class="sect3">
<h4 id="_jvm_npm">4.1.1. JVM-NPM</h4>

</div>
</div>
<div class="sect2">
<h3 id="_maven">4.2. Maven</h3>
<div class="sect3">
<h4 id="_nasven">4.2.1. Nasven</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_isomorphic_javascript">5. Isomorphic JavaScript</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_isomorphic">5.1. Isomorphic?</h3>

</div>
<div class="sect2">
<h3 id="_react_js">5.2. React.js</h3>

</div>
<div class="sect2">
<h3 id="_spring_boot_mvc">5.3. Spring Boot MVC</h3>

</div>
<div class="sect2">
<h3 id="_java_ee_8_mvc_1_0">5.4. Java EE 8 MVC 1.0</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_javafx_with_javascript">6. JavaFX with JavaScript</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_testing_of_nashorn_scripts">7. Testing of Nashorn Scripts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_junit">7.1. JUnit</h3>

</div>
<div class="sect2">
<h3 id="_spock">7.2. Spock</h3>

</div>
<div class="sect2">
<h3 id="_jasmine">7.3. Jasmine</h3>

</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-01-24 12:29:57 UTC
</div>
</div>
</body>
</html>